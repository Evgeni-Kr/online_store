<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ö–æ—Ä–∑–∏–Ω–∞</title>
    <div th:replace="~{common :: styles}"></div>
    <link rel="stylesheet" th:href="@{/styles/shopCartMain.css}">
    <script th:src="@{/js/burgerMenu.js}"></script>

</head>
<body>
<div th:replace="~{common :: header}"></div>
<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" id="csrfTokenInput"/>
<div th:replace="~{common :: burger-menu}"></div>
<div th:replace="~{common :: burger-menu__ovelay}"></div>

<main class="cart-main">
    <div class="cart-header">
        <h1>üõí –í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h1>
        <p>–¢–æ–≤–∞—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –≤—ã–±—Ä–∞–ª–∏</p>
    </div>

    <div class="cart-content" th:if="${!cart.items.isEmpty()}">
        <!-- –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ -->
        <div class="cart-items">
            <div class="cart-item" th:each="item : ${cart.items}">
                <div class="cart-item-image">
                    <img th:if="${item.product.previewImageId != null}"
                         th:src="@{/image/{id}(id=${item.product.previewImageId})}"
                         th:alt="${item.product.name}"
                         src="/images/placeholder.jpg">
                    <img th:unless="${item.product.previewImageId != null}"
                         src="/images/placeholder.jpg"
                         th:alt="${item.product.name}">
                </div>
                <div class="cart-item-details">
                    <h3 class="cart-item-title" th:text="${item.product.name}">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h3>
                    <div class="cart-item-price" th:text="${item.product.price}">999.99 ‚ÇΩ</div>
                    <!-- –ò–∑–º–µ–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ -->
                    <div class="cart-item-quantity">
                        <form th:action="@{/shopCart/update/{id}(id=${item.product.id})}" method="post"
                              style="display: inline;">
                            <input type="hidden" name="_method" value="put"/>
                            <input type="hidden" name="quantity" th:value="${item.quantity - 1}"/>
                            <button type="submit" class="quantity-btn" th:disabled="${item.quantity <= 1}">-</button>
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        </form>
                        <label>
                            <input type="number" class="quantity-input" th:value="${item.quantity}" min="1" readonly>
                        </label>
                        <form th:action="@{/shopCart/update/{id}(id=${item.product.id})}" method="post"
                              style="display: inline;">
                            <input type="hidden" name="_method" value="put"/>
                            <input type="hidden" name="quantity" th:value="${item.quantity + 1}"/>
                            <button type="submit" class="quantity-btn">+</button>
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        </form>
                    </div>

                    <!-- –û–±–Ω–æ–≤–∏—Ç–µ –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è -->
                    <div class="cart-item-actions">
                        <!-- –ò—Å–ø–æ–ª—å–∑—É–µ–º th:attr –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è URL -->
                        <form th:action="@{/shopCart/remove/{id}(id=${item.product.id})}" method="post">
                            <input type="hidden" name="_method" value="DELETE"/>
                            <button type="submit" class="remove-btn">
                                ‚ùå –£–¥–∞–ª–∏—Ç—å
                            </button>
                            <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        </form>
                    </div>
                </div>
            </div>

            <!-- –î—Ä—É–≥–∏–µ —Ç–æ–≤–∞—Ä—ã... -->
        </div>

        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –∏—Ç–æ–≥–∞–º–∏ -->
        <div class="cart-summary">
            <h2>–ò—Ç–æ–≥–∏ –∑–∞–∫–∞–∑–∞</h2>
            <div class="summary-details">
                <div class="summary-row">
                    <span class="summary-label">–¢–æ–≤–∞—Ä—ã (<span th:text="${cart.totalItems}">3</span>)</span>
                    <span class="summary-value" th:text="${cart.totalPrice}">2 999.97 ‚ÇΩ</span>
                </div>
                <div class="summary-row">
                    <span class="summary-label">–î–æ—Å—Ç–∞–≤–∫–∞</span>
                    <span class="summary-value">–ë–µ—Å–ø–ª–∞—Ç–Ω–æ</span>
                </div>
                <div class="summary-row">
                    <span class="summary-label">–°–∫–∏–¥–∫–∞</span>
                    <span class="summary-value">-0 ‚ÇΩ</span>
                </div>
                <div class="summary-row summary-total">
                    <span class="summary-label">–ò—Ç–æ–≥–æ</span>
                    <span class="summary-value" th:text="${cart.totalPrice}">2 999.97 ‚ÇΩ</span>
                </div>
            </div>

            <div class="shipping-progress">
                <div class="free-shipping-message">üéâ –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞!</div>
                <div class="shipping-progress-bar">
                    <div class="shipping-progress-fill" style="width: 100%"></div>
                </div>
                <small>–í—ã –ø–æ–ª—É—á–∏–ª–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –¥–æ—Å—Ç–∞–≤–∫—É</small>
            </div>

            <button class="order-btn" id="order-btn" type="button">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
            <a th:href="@{/product/get/products}" class="continue-shopping">‚Üê –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –ø–æ–∫—É–ø–∫–∏</a>
        </div>
    </div>

    <div th:if="${cart.items.isEmpty()}" class="empty-cart">
        <p class="no-content">–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
        <a th:href="@{/product/get/products}" class="continue-shopping">‚Üê –ù–∞—á–∞—Ç—å –ø–æ–∫—É–ø–∫–∏</a>
    </div>

</main>
<div th:replace="~{common :: footer}"></div>
<script th:src="@{/js/toOrder.js}"></script>
</body>
</html>